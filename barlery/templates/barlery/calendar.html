{% extends "barlery/base.html" %}
{% load static %}

{% block head %}
<title>Events Calendar | Barlery</title>
<meta name="description" content="Check out our upcoming events - live music, performances, and special nights at Barlery.">
{% endblock head %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/calendar.css' %}{% if STATIC_VERSION %}?v={{ STATIC_VERSION }}{% endif %}">
{% endblock extra_css %}

{% block extra_scripts %}
<script src="{% static 'js/calendar_upcoming_events.js' %}" defer></script>
{% endblock extra_scripts %}

{% block body %}

<!-- Hero Section -->
<section class="hero-simple">
  <div class="container">
    <h1>Events Calendar</h1>
    <p class="hero-subtitle">Live Music, Performances & Special Events</p>
  </div>
</section>

<!-- Calendar Section -->
<section class="section">
  <div class="container">
    
    <!-- Quick Actions -->
    {% if user.is_authenticated %}
    <div class="calendar-actions">
      <a href="{% url 'barlery:event_create' %}" class="btn btn-primary btn-sm">
        <i class="fas fa-plus"></i> Add New Event
      </a>
    </div>
    {% endif %}

    {% if upcoming_events %}
    <!-- Calendar Container with Header -->
    <div class="calendar-container">
      <!-- Calendar Header with Month Navigation - sits on top of calendar -->
      <div class="calendar-header">
        <a href="?year={{ prev_year }}&month={{ prev_month }}" class="calendar-nav-btn calendar-nav-prev" title="Previous Month">
          <i class="fas fa-chevron-left"></i>
        </a>
        <h2 class="calendar-title">{{ month_name }} {{ year }}</h2>
        <a href="?year={{ next_year }}&month={{ next_month }}" class="calendar-nav-btn calendar-nav-next" title="Next Month">
          <i class="fas fa-chevron-right"></i>
        </a>
      </div>

      <!-- Calendar Grid -->
      <div class="calendar-grid">
        <!-- Day Headers -->
        <div class="calendar-day-header">Sunday</div>
        <div class="calendar-day-header">Monday</div>
        <div class="calendar-day-header">Tuesday</div>
        <div class="calendar-day-header">Wednesday</div>
        <div class="calendar-day-header">Thursday</div>
        <div class="calendar-day-header">Friday</div>
        <div class="calendar-day-header">Saturday</div>

        <!-- Calendar Days -->
        {% for week in calendar_weeks %}
          {% for day_data in week %}
            {% if day_data.day %}
              <div class="calendar-day {% if day_data.is_today %}today{% endif %} {% if day_data.is_past %}past{% endif %} {% if day_data.events %}has-events{% endif %}">
                <div class="day-number">{{ day_data.day }}</div>
                <div class="day-events">
                  {% for event in day_data.events %}
                    <a href="{% url 'barlery:event_details' event.id %}" class="event-badge" title="{{ event.title }} at {{ event.start_time|time:'g:i A' }}">
                      <span class="event-time">{{ event.start_time|time:'g:i A' }}</span>
                      <span class="event-title">{{ event.title }}</span>
                    </a>
                  {% endfor %}
                </div>
              </div>
            {% else %}
              <div class="calendar-day empty"></div>
            {% endif %}
          {% endfor %}
        {% endfor %}
      </div>
    </div>

    {% else %}
    <section class="section section-light">
      <div class="container">
        <h2 class="section-title">Check back soon!</h2>
        <p style="text-align: center; font-size: 1.2rem; line-height: 1.8; margin-bottom: var(--space-lg); opacity: 0.95;">In the meantime, follow us on social mediate for events & special announcements:</p>
        <div class="social-links">
          <a href="https://www.instagram.com/barlery.chat/" aria-label="Instagram" style="color: var(--color-primary); transition: var(--transition);" onmouseover="this.style.color='var(--color-primary-light)'" onmouseout="this.style.color='var(--color-primary)'">
            <i class="fab fa-instagram"></i> Instagram
          </a>
          <a href="https://www.facebook.com/profile.php?id=61583437177852" aria-label="Facebook" style="color: var(--color-primary); transition: var(--transition);" onmouseover="this.style.color='var(--color-primary-light)'" onmouseout="this.style.color='var(--color-primary)'">
            <i class="fab fa-facebook"></i> Facebook
          </a>
        </div>
      </div>
    </section>
    {% endif %}
  </div>
</section>
<!-- Upcoming Events Sidebar/Section -->
<!--
<section class="section section-light">
  <div class="container">
    <h2 class="section-title">Upcoming Events</h2>
    <div class="upcoming-events-list" id="upcoming-events-list">
      {% for event in upcoming_events %}
      <a href="{% url 'barlery:event_details' event.id %}" class="upcoming-event-item{% if forloop.counter > 3 %} event-hidden{% endif %}" data-event-index="{{ forloop.counter }}">
        <div class="event-date-badge">
          <div class="event-month">{{ event.date|date:'M' }}</div>
          <div class="event-day">{{ event.date|date:'d' }}</div>
        </div>
        <div class="event-info">
          <h3>{{ event.title }}</h3>
          <p class="event-meta">
            <i class="far fa-clock"></i> {{ event.start_time|time:'g:i A' }}
            {% if event.end_time %}
              - {{ event.end_time|time:'g:i A' }}
            {% endif %}
          </p>
          {% if event.description %}
          <p class="event-description">{{ event.description|truncatechars:100 }}</p>
          {% endif %}
        </div>
      </a>
      {% endfor %}
    </div>
    
    {% if upcoming_events|length > 3 %}
    <div class="load-more-container" style="text-align: center; margin-top: var(--space-lg);">
      <button id="load-more-events-btn" class="btn btn-accent">
        Load More Events
      </button>
    </div>
    {% endif %}
  </div>
</section>
-->

<!-- CTA Section -->
<section class="section section-burgundy section-textured">
  <div class="container-narrow text-center">
    <h2>Want to Host an Event?</h2>
    <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: var(--space-lg); opacity: 0.95;">
      Interested in booking the venue for your own performance or private event? 
      We'd love to hear from you!
    </p>
    <a href="{% url 'barlery:venue' %}" class="btn btn-accent">Request Venue Rental</a>
  </div>
</section>

{% endblock body %}